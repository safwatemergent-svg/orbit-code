<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orbit AI Chat - Space Exploration Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0a0a0a;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(40, 40, 60, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(40, 40, 60, 0.3) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0a 0%, #0f0f1a 100%);
            color: #ffffff;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .navbar {
            background: rgba(10, 10, 10, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .navbar-brand {
            color: #ffffff !important;
            font-weight: normal;
            opacity: 0.9;
            transition: opacity 0.2s ease;
        }
        
        .navbar-brand:hover {
            opacity: 1;
        }

        .navbar-brand i {
            color: #4fc3f7;
            margin-right: 10px;
        }

        .hero-section {
            padding: 60px 0;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 20px;
            text-shadow: 0 0 30px rgba(79, 195, 247, 0.8);
            animation: titleFloat 4s ease-in-out infinite, titleColorShift 6s ease-in-out infinite alternate;
            position: relative;
            z-index: 2;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: #e1f5fe;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            animation: subtitleGlow 3s ease-in-out infinite alternate;
            position: relative;
            z-index: 2;
        }

        .stars-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 30%, rgba(79, 195, 247, 0.3) 0%, transparent 50%),
                        radial-gradient(circle at 80% 70%, rgba(13, 71, 161, 0.2) 0%, transparent 50%),
                        linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(13, 71, 161, 0.1) 100%);
            overflow: hidden;
        }

        .stars-background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, #4fc3f7, transparent),
                radial-gradient(2px 2px at 40px 70px, #0d47a1, transparent),
                radial-gradient(1px 1px at 90px 40px, #4fc3f7, transparent),
                radial-gradient(1px 1px at 130px 80px, #0d47a1, transparent),
                radial-gradient(2px 2px at 160px 30px, #4fc3f7, transparent);
            background-repeat: repeat;
            background-size: 200px 100px;
            animation: starsTwinkle 3s ease-in-out infinite alternate;
        }

        .hero-title {
            position: relative;
            z-index: 2;
            animation: titleFloat 4s ease-in-out infinite;
        }

        .hero-subtitle {
            position: relative;
            z-index: 2;
            animation: subtitleGlow 3s ease-in-out infinite alternate;
        }

        .famous-prompts-section {
            background: rgba(0, 0, 0, 0.8);
            padding: 50px 0;
            position: relative;
        }

        .prompts-title {
            text-align: center;
            color: #4fc3f7;
            font-size: 2rem;
            margin-bottom: 40px;
            text-shadow: 0 0 20px rgba(79, 195, 247, 0.8);
            animation: titlePulse 2s ease-in-out infinite;
        }

        .prompts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .prompt-btn {
            background: rgba(13, 71, 161, 0.8);
            border: 2px solid rgba(79, 195, 247, 0.3);
            border-radius: 15px;
            padding: 20px;
            color: white;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
        }

        .prompt-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(79, 195, 247, 0.2), transparent);
            transition: left 0.5s;
        }

        .prompt-btn:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #4fc3f7;
            box-shadow: 0 10px 30px rgba(79, 195, 247, 0.3);
        }

        .prompt-btn:hover::before {
            left: 100%;
        }

        .prompt-icon {
            font-size: 1.5rem;
            animation: iconBounce 2s ease-in-out infinite;
        }

        @keyframes starsTwinkle {
            0% { opacity: 0.3; }
            100% { opacity: 0.8; }
        }

        @keyframes titleFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes subtitleGlow {
            0%, 100% { text-shadow: 0 0 10px rgba(79, 195, 247, 0.5); }
            50% { text-shadow: 0 0 20px rgba(79, 195, 247, 0.8); }
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes iconBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .chat-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        .chat-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-height: 500px;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            text-align: center;
            position: relative;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 1.4rem;
            font-weight: bold;
        }

        .chat-header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .chat-header .status {
            position: absolute;
            top: 15px;
            right: 20px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4caf50;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            max-height: 400px;
        }

        .message {
            margin-bottom: 20px;
            padding: 15px 20px;
            border-radius: 18px;
            max-width: 70%;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease-in;
        }

        .message.user {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-left: auto;
            text-align: right;
            border-bottom-right-radius: 5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .message.ai {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border-bottom-left-radius: 5px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .message.orbit {
            background: linear-gradient(135deg, #4fc3f7 0%, #29b6f6 100%);
            color: white;
            text-align: center;
            max-width: 80%;
            margin: 20px auto;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.3);
        }

        .message p {
            margin: 0;
            font-size: 1rem;
            line-height: 1.5;
        }

        .message .timestamp {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-top: 5px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-input {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            border-radius: 0 0 20px 20px;
        }

        .chat-input .input-group {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .chat-input textarea {
            background: transparent;
            border: none;
            color: white;
            resize: none;
            padding: 15px 20px;
            font-size: 1rem;
            line-height: 1.4;
            flex: 1;
        }

        .chat-input textarea:focus {
            outline: none;
            box-shadow: none;
        }

        .chat-input textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .chat-input button {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 0 30px 30px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .chat-input button:hover {
            background: linear-gradient(135deg, #45a049 0%, #4caf50 100%);
            transform: scale(1.05);
        }

        .chat-container:hover {
            transform: scale(1.01);
            transition: transform 0.3s ease;
        }

        .chat-box {
            transition: all 0.3s ease;
        }

        .chat-box:hover {
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.4);
        }

        .message {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .message:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(79, 195, 247, 0.2);
        }

        .message.user:hover {
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .chat-input {
            transition: all 0.3s ease;
        }

        .chat-input:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        .chat-input textarea {
            transition: all 0.3s ease;
        }

        .chat-input textarea:focus {
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.3);
        }

        .chat-input button {
            transition: all 0.3s ease;
        }

        .chat-input button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }

        .typing-indicator {
            display: none;
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-style: italic;
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin: 10px 0;
        }

        .typing-indicator::after {
            content: '...';
            animation: typing 1.5s infinite;
        }

        @keyframes typing {
            0%, 20%, 50%, 80% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            70% { content: '...'; }
        }

        .context-info {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px 20px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .context-info h5 {
            color: #4fc3f7;
            margin: 0 0 10px 0;
            font-size: 1.1rem;
        }

        .context-info p {
            margin: 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .context-info .prediction-data {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 0.8rem;
        }

        .error-message {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid rgba(244, 67, 54, 0.3);
            color: #ffcdd2;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: rgba(255, 255, 255, 0.6);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer img {
            width: 20px;
            height: 20px;
            margin: 0 5px;
            border-radius: 50%;
        }

        .prediction-button-section {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(26, 35, 126, 0.3) 50%, rgba(13, 71, 161, 0.2) 100%);
            padding: 40px 0;
            border-bottom: 1px solid rgba(79, 195, 247, 0.3);
            position: relative;
            overflow: hidden;
        }

        .prediction-button-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 50%, rgba(79, 195, 247, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 70% 20%, rgba(13, 71, 161, 0.1) 0%, transparent 50%);
            animation: backgroundPulse 4s ease-in-out infinite alternate;
        }

        .prediction-card {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            border: 1px solid rgba(79, 195, 247, 0.3);
            padding: 30px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            max-width: 600px;
            margin: 0 auto;
            animation: slideInUp 0.8s ease-out, cardFloat 6s ease-in-out infinite;
            position: relative;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .prediction-card::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #4fc3f7, #0d47a1, #4fc3f7, #0d47a1);
            border-radius: 22px;
            z-index: -1;
            animation: borderGlow 3s ease-in-out infinite;
        }

        .prediction-icon {
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0d47a1 0%, #1565c0 50%, #1976d2 100%);
            border-radius: 50%;
            color: white;
            font-size: 2rem;
            box-shadow: 0 4px 20px rgba(13, 71, 161, 0.5);
            animation: iconPulse 2s infinite, iconRotate 8s linear infinite;
            position: relative;
        }

        .prediction-icon::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border: 2px solid rgba(79, 195, 247, 0.3);
            border-radius: 50%;
            animation: iconRing 3s ease-in-out infinite;
        }

        .prediction-content h3 {
            color: #4fc3f7;
            margin: 0 0 10px 0;
            font-size: 1.4rem;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(79, 195, 247, 0.8);
            animation: textGlow 2s ease-in-out infinite alternate;
        }

        .prediction-content p {
            color: #e1f5fe;
            margin: 0 0 20px 0;
            opacity: 0.9;
            line-height: 1.6;
        }

        .prediction-btn {
            display: inline-block;
            background: linear-gradient(135deg, #0d47a1 0%, #1565c0 50%, #1976d2 100%);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-weight: bold;
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(13, 71, 161, 0.4);
            border: 2px solid transparent;
        }

        .prediction-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .prediction-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 30px rgba(13, 71, 161, 0.6);
            border-color: #4fc3f7;
        }

        .prediction-btn:hover::before {
            left: 100%;
        }

        .prediction-btn-glow {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(79, 195, 247, 0.3), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }

        .prediction-btn:hover .prediction-btn-glow {
            transform: translateX(100%);
        }

        .prediction-btn-particles {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(79, 195, 247, 0.8);
            border-radius: 50%;
            animation: particleFloat 3s infinite ease-in-out;
        }

        .particle:nth-child(1) {
            top: 20%;
            left: 20%;
            animation-delay: 0s;
        }

        .particle:nth-child(2) {
            top: 60%;
            left: 80%;
            animation-delay: 0.5s;
        }

        .particle:nth-child(3) {
            top: 80%;
            left: 40%;
            animation-delay: 1s;
        }

        .particle:nth-child(4) {
            top: 30%;
            left: 70%;
            animation-delay: 1.5s;
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes cardFloat {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        @keyframes borderGlow {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.8;
            }
        }

        @keyframes iconPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes iconRotate {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes iconRing {
            0%, 100% {
                transform: scale(1);
                opacity: 0.3;
            }
            50% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }

        @keyframes textGlow {
            0%, 100% {
                text-shadow: 0 0 15px rgba(79, 195, 247, 0.8);
            }
            50% {
                text-shadow: 0 0 25px rgba(79, 195, 247, 1);
            }
        }

        @keyframes backgroundPulse {
            0%, 100% {
                opacity: 0.3;
            }
            50% {
                opacity: 0.6;
            }
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0) scale(0);
                opacity: 0;
            }
            50% {
                transform: translateY(-20px) scale(1);
                opacity: 1;
            }
        }

        @media (max-width: 768px) {
            .prediction-card {
                flex-direction: column;
                gap: 20px;
                padding: 25px;
            }

            .prediction-icon {
                width: 60px;
                height: 60px;
                font-size: 1.5rem;
            }

            .prediction-content h3 {
                font-size: 1.2rem;
            }

            .prediction-btn {
                padding: 12px 25px;
                font-size: 0.9rem;
            }

            .prompts-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .prompt-btn {
                padding: 15px;
                font-size: 1rem;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .prompts-title {
                font-size: 1.5rem;
            }
        }
    </style>

    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="index.html" style="color: #fff !important;">
                <i class="fas fa-arrow-left"></i> Back
            </a>
        </div>
    </nav>

    <div class="prediction-button-section">
        <div class="container">
            <div class="prediction-card">
                <div class="prediction-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.937A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .962 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.582a.5.5 0 0 1 0 .962L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.962 0z"/>
                        <path d="M12 2v4"/>
                        <path d="M12 18v4"/>
                        <path d="M4.93 4.93l2.83 2.83"/>
                        <path d="M16.24 16.24l2.83 2.83"/>
                        <path d="M2 12h4"/>
                        <path d="M18 12h4"/>
                        <path d="M4.93 19.07l2.83-2.83"/>
                        <path d="M16.24 7.76l2.83-2.83"/>
                    </svg>
                </div>
                <div class="prediction-content">
                    <h3>Ready to Make an AI Prediction?</h3>
                    <p>Use our advanced AI model to predict exoplanet characteristics and discover new worlds in the cosmos.</p>
                    <a href="prediction.html" class="prediction-btn" onclick="navigateToPrediction()">
                        <span>Make AI Prediction</span>
                        <div class="prediction-btn-glow"></div>
                        <div class="prediction-btn-particles">
                            <div class="particle"></div>
                            <div class="particle"></div>
                            <div class="particle"></div>
                            <div class="particle"></div>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="hero-section">
        <div class="stars-background"></div>
        <div class="container">
            <h1 class="hero-title">
                <i class="fas fa-rocket"></i> Orbit AI Chat
            </h1>
            <p class="hero-subtitle">
                Your intelligent space exploration companion. Ask about exoplanets, astrophysics, astronomical phenomena, and get insights from your prediction results.
            </p>
        </div>
    </div>

    <!-- Famous Prompts Section -->
    <div class="famous-prompts-section">
        <div class="container">
            <h2 class="prompts-title">Popular Space Questions</h2>
            <div class="prompts-grid">
                <button class="prompt-btn" data-prompt="What are black holes and how do they form?">
                    <div class="prompt-icon">🌌</div>
                    <span>What are black holes?</span>
                </button>
                <button class="prompt-btn" data-prompt="How does gravity work in space?">
                    <div class="prompt-icon">🌍</div>
                    <span>How does gravity work?</span>
                </button>
                <button class="prompt-btn" data-prompt="Explain the Big Bang theory">
                    <div class="prompt-icon">💥</div>
                    <span>Big Bang theory</span>
                </button>
                <button class="prompt-btn" data-prompt="What are exoplanets and how do we find them?">
                    <div class="prompt-icon">🪐</div>
                    <span>What are exoplanets?</span>
                </button>
                <button class="prompt-btn" data-prompt="How do stars form and evolve?">
                    <div class="prompt-icon">⭐</div>
                    <span>How do stars form?</span>
                </button>
                <button class="prompt-btn" data-prompt="What is dark matter and dark energy?">
                    <div class="prompt-icon">🌑</div>
                    <span>Dark matter & energy</span>
                </button>
            </div>
        </div>
    </div>

    <div class="chat-container">
        <div id="contextInfo" class="context-info" style="display: none;">
            <h5><i class="fas fa-brain"></i> Prediction Context Available</h5>
            <p>I have access to your recent exoplanet prediction results. You can ask follow-up questions about specific predictions or general space-related queries.</p>
            <div class="prediction-data" id="predictionContext"></div>
        </div>

        <div class="chat-box">
            <div class="chat-header">
                <div class="status"></div>
                <h3>Orbit AI Assistant</h3>
                <p>Powered by Meta Llama 3.3 70B Instruct</p>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message ai">
                    <p>
                        <i class="fas fa-star"></i> Welcome to Orbit AI! I'm your space exploration expert powered by advanced AI.
                    I specialize in astronomy, astrophysics, and exoplanet science.
                    </p>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #4fc3f7;">
                        <p style="margin: 0 0 10px 0; font-weight: bold;">🚀 Space-Related Topics I Can Help With:</p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 0.9rem;">
                            <ul style="margin: 0; padding-left: 20px; flex: 1;">
                                <li>Exoplanet discovery & classification</li>
                                <li>Astronomical phenomena (supernovae, black holes, nebulae)</li>
                                <li>NASA missions (Kepler, TESS, Hubble)</li>
                                <li>Stellar systems & star formation</li>
                                <li>Galactic structures & Milky Way</li>
                                <li>Space technology & spacecraft</li>
                            </ul>
                            <ul style="margin: 0; padding-left: 20px; flex: 1;">
                                <li>Planetary science & atmospheres</li>
                                <li>Cosmology & Big Bang theory</li>
                                <li>Solar system planets & moons</li>
                                <li>Asteroids, comets & meteoroids</li>
                                <li>Light years, parsecs & distances</li>
                                <li>Telescope technology & observations</li>
                                <li>Gravitational waves & relativity</li>
                                <li>Space colonization & exploration</li>
                            </ul>
                        </div>
                    </div>
                    <p>How can I help you explore the cosmos today?</p>
                    <div class="timestamp"><i class="fas fa-clock"></i> Just now</div>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                Orbit AI is thinking about the cosmos
            </div>

            <div class="chat-input">
                <div class="input-group">
                    <textarea
                        id="messageInput"
                        placeholder="Ask me about space, exoplanets, or your predictions..."
                        rows="1"
                        maxlength="1000"
                    ></textarea>
                    <button id="sendButton" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i> Send
                    </button>
                </div>
            </div>
        </div>

        <div id="errorMessage" class="error-message" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i> Unable to connect to Orbit AI. Please check your connection and try again.
        </div>
    </div>

    <div class="footer">
        <p>
            <i class="fas fa-shield-alt"></i>
            Orbit AI responses are for educational purposes only.
            <img src="meta.png" alt="Meta" style="margin-left: 10px;"> Powered by Meta Llama 3.3 70B Instruct
        </p>
    </div>

    <script>
        // Load environment variables or use defaults
        const API_KEY = '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';
        const API_URL = 'https://openrouter.ai/api/v1/chat/completions';
        const MODEL = 'meta-llama/llama-3.3-70b-instruct:free';

        let chatHistory = [];
        let predictionContext = null;

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load prediction context from URL or localStorage
            loadPredictionContext();

            // Set up event listeners
            setupEventListeners();

            // Auto-resize textarea
            setupTextareaAutoResize();

            // Focus on input
            document.getElementById('messageInput').focus();
        });

        function loadPredictionContext() {
            try {
                // Check URL parameters first
                const urlParams = new URLSearchParams(window.location.search);
                const contextParam = urlParams.get('context');

                if (contextParam) {
                    predictionContext = JSON.parse(decodeURIComponent(contextParam));
                    showContextInfo(predictionContext);
                    return;
                }

                // Check localStorage for recent predictions
                const recentPrediction = localStorage.getItem('lastPrediction');
                if (recentPrediction) {
                    predictionContext = JSON.parse(recentPrediction);
                    showContextInfo(predictionContext);
                }
            } catch (error) {
                console.warn('Could not load prediction context:', error);
            }
        }

        function showContextInfo(context) {
            const contextDiv = document.getElementById('contextInfo');
            const contextData = document.getElementById('predictionContext');

            contextData.textContent = JSON.stringify({
                prediction: context.prediction,
                confidence: (context.confidence * 100).toFixed(2) + '%',
                parameters: context.input_provided,
                timestamp: new Date().toLocaleString()
            }, null, 2);

            contextDiv.style.display = 'block';
        }

        function setupEventListeners() {
            const input = document.getElementById('messageInput');
            const button = document.getElementById('sendButton');

            // Enter key to send (Ctrl+Enter for new line)
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.ctrlKey && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // Auto-resize textarea
            input.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = this.scrollHeight + 'px';
            });

            // Famous prompt buttons
            document.querySelectorAll('.prompt-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const prompt = this.getAttribute('data-prompt');
                    // Fill the input with the prompt and send it
                    input.value = prompt;
                    input.focus();
                    // Auto-send after a short delay for better UX
                    setTimeout(() => sendMessage(), 100);
                });
            });

            // Prediction button navigation
            const predictionBtn = document.querySelector('.prediction-btn');
            if (predictionBtn) {
                predictionBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('Prediction button clicked, navigating to prediction.html');
                    window.location.href = 'prediction.html';
                });
            }
        }

        function setupTextareaAutoResize() {
            const textarea = document.getElementById('messageInput');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const button = document.getElementById('sendButton');
            const message = input.value.trim();

            if (!message) {
                return;
            }

            // Add user message to chat
            addMessage('user', message);
            input.value = '';

            // Show typing indicator
            showTypingIndicator();

            // Disable input while processing
            input.disabled = true;
            button.disabled = true;

            try {
                // Check if message is space-related
                if (!isSpaceRelated(message)) {
                    hideTypingIndicator();
                    addMessage('orbit', '🚫 I apologize, but I can only answer questions related to space, astronomy, astrophysics, and exoplanets. Please ask me about cosmos or space related topics.');
                    resetInput();
                    return;
                }

                // Prepare messages for API
                const messages = prepareMessages(message);

                console.log('Sending to OpenRouter:', messages);

                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`,
                        'HTTP-Referer': window.location.href,
                        'X-Title': 'Orbit AI Space Chat'
                    },
                    body: JSON.stringify({
                        model: MODEL,
                        messages: messages,
                        temperature: 0.7,
                        max_tokens: 1000,
                        top_p: 0.9
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }

                const data = await response.json();
                console.log('OpenRouter response:', data);

                const aiResponse = data.choices[0].message.content;

                // Hide typing indicator
                hideTypingIndicator();

                // Add AI response
                addMessage('ai', aiResponse);

                // Store in chat history
                chatHistory.push({ role: 'user', content: message });
                chatHistory.push({ role: 'assistant', content: aiResponse });

            } catch (error) {
                console.error('Error sending message:', error);
                hideTypingIndicator();
                document.getElementById('errorMessage').style.display = 'block';

                // Add error message to chat
                addMessage('orbit', '🚨 I\'m experiencing technical difficulties connecting to my cosmic databases. Please try your question again in a moment.');

                setTimeout(() => {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 5000);
            }

            // Reset input
            resetInput();
        }

        function prepareMessages(userMessage) {
            const messages = [
                {
                    role: 'system',
                    content: `You are Orbit AI, a specialized space exploration assistant powered by Meta Llama 3.3 70B Instruct. You ONLY discuss topics related to:

SPACE SCIENCE TOPICS (allowed):
• Exoplanets, their characteristics, classification, and detection
• Astronomy and astrophysical phenomena
• Stellar systems, galaxies, and cosmology
• NASA missions and space exploration
• Astronomical data analysis and interpretation
• Space technology and instrumentation
• Planetary science and comparative planetology

STRICT RESTRICTIONS:
• You MUST refuse any questions not related to space/astronomy
• Politely redirect non-space queries to space-related topics
• Never discuss politics, current events, entertainment, or general AI topics
• Always stay in character as a space exploration expert

RESPONSE STYLE:
• Use astronomical terminology appropriately
• Be helpful, accurate, and engaging
• Reference real astronomical data when possible
• Encourage curiosity about space exploration
• Start responses with space-related emojis when appropriate`
                }
            ];

            // Add prediction context if available
            if (predictionContext) {
                messages.push({
                    role: 'system',
                    content: `CONTEXT: The user recently made an exoplanet prediction with these results:
Prediction: ${predictionContext.prediction}
Confidence: ${(predictionContext.confidence * 100).toFixed(2)}%
Parameters: ${JSON.stringify(predictionContext.input_provided)}

You can reference this context when answering questions about their specific prediction or follow-up questions.`
                });
            }

            // Add recent chat history (limit to last 4 messages to stay within token limits)
            const recentHistory = chatHistory.slice(-4);
            messages.push(...recentHistory.map(msg => ({
                role: msg.role === 'assistant' ? 'assistant' : 'user',
                content: msg.content
            })));

            // Add current user message
            messages.push({
                role: 'user',
                content: userMessage
            });

            return messages;
        }

        function isSpaceRelated(message) {
            const spaceKeywords = [
                'space', 'astronomy', 'astrophysics', 'exoplanet', 'planet', 'star', 'galaxy',
                'cosmos', 'universe', 'nasa', 'telescope', 'orbit', 'solar system', 'moon',
                'mars', 'jupiter', 'saturn', 'venus', 'mercury', 'nebula', 'black hole',
                'supernova', 'comet', 'asteroid', 'meteor', 'gravity', 'light year',
                'parsec', 'magnitude', 'spectrum', 'transit', 'kepler', 'tess', 'k2',
                'orbital period', 'planet radius', 'transit depth', 'equilibrium temperature',
                'insolation flux', 'stellar', 'habitable', 'earth-like', 'gas giant',
                'terrestrial', 'super-earth', 'hot jupiter', 'mini-neptune',

                // Dark matter and dark energy specific keywords
                'dark matter', 'dark energy', 'darkmatter', 'darkenergy', 'cdm', 'wimp',
                'weakly interacting massive particles', 'lambda cdm', 'cosmological constant',
                'cosmic web', 'large scale structure', 'galaxy rotation curve', 'bullet cluster',
                'gravitational lensing', 'cmb', 'cosmic microwave background', 'baryon acoustic',
                'vacuum energy', 'quintessence', 'dark flow', 'modified newtonian dynamics', 'mond',

                // Additional comprehensive space-related keywords
                'milky way', 'andromeda', 'milkyway', 'cosmic', 'celestial', 'astronomical',
                'cosmology', 'big bang', 'multiverse', 'wormhole', 'warp', 'hyperspace',
                'constellation', 'zenith', 'nadir', 'meridian', 'aphelion', 'perihelion',
                'eclipse', 'occultation', 'transit', 'conjunction', 'opposition',
                'astronaut', 'mission', 'spacex', 'blue origin', 'spacestation', 'iss',
                'rocket', 'satellite', 'spacecraft', 'lander', 'rover', 'probe',
                'crater', 'meteoroid', 'bolide', 'fireball', 'perseid', 'meteor shower',
                'aurora', 'northern lights', 'southern lights', 'magnetosphere', 'ionosphere',
                'radiation', 'x-ray', 'gamma ray', 'ultraviolet', 'infrared', 'radio wave',
                'spectroscopy', 'photometry', 'astrometry', 'interferometry', 'tides',
                'corona', 'photosphere', 'chromosphere', 'heliosphere', 'bow shock',
                'magnetar', 'pulsar', 'quasar', 'blazar', 'neutron star', 'white dwarf',
                'brown dwarf', 'red giant', 'main sequence', 'cepheid', 'rr lyrae',
                'globular cluster', 'open cluster', 'supergiant', 'hypergiant', 'nova',
                'asteroid belt', 'kuiper belt', 'oort cloud', 'goldilocks zone',
                'habitable zone', 'circumstellar', 'exozodiacal', 'zodiacal light',
                'heliocentric', 'geocentric', 'galactocentric', 'heliopause', 'termination shock'
            ];

            const lowerMessage = message.toLowerCase();

            // Check if any space keywords are present
            return spaceKeywords.some(keyword => lowerMessage.includes(keyword));
        }

        function addMessage(type, content) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;

            const timestamp = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            messageDiv.innerHTML = `
                <p>${content.replace(/\n/g, '<br>')}</p>
                <div class="timestamp"><i class="fas fa-clock"></i> ${timestamp}</div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'block';
        }

        function hideTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'none';
        }

        function resetInput() {
            const input = document.getElementById('messageInput');
            const button = document.getElementById('sendButton');

            input.disabled = false;
            button.disabled = false;
            input.style.height = 'auto';
            input.focus();
        }

        // Function to store prediction context (call this from main prediction page)
        function storePredictionContext(predictionData) {
            localStorage.setItem('lastPrediction', JSON.stringify(predictionData));
        }

        // Function to navigate back with context
        function navigateWithContext() {
            if (predictionContext) {
                const contextParam = encodeURIComponent(JSON.stringify(predictionContext));
                window.location.href = `index.html?chat_return=true&context=${contextParam}`;
            } else {
                window.location.href = 'index.html';
            }
        }

        // Function to navigate to prediction page
        function navigateToPrediction() {
            console.log('navigateToPrediction called');
            window.location.href = 'prediction.html';
            return false; // Prevent default link behavior
        }
    </script>
</body>
</html>
